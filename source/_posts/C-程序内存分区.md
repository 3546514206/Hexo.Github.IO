---
title: C++程序内存分区
date: 2023-08-29 01:14:22
categories: 
- 基本功
- 编程基础
- C++
tags:
- C++
- Java
---

__代码区：__ 程序被操作系统加载到内存时，所有可执⾏的代码被加载到代码区，也叫代码段，存储程序的代码指令。程序运⾏时，代码区是共享只读的。

__静态区：__ 程序中的静态变量、全局变量存放在此区域（初始化的全局变量和静态变量在⼀块区域）。代码执⾏期间⼀直占⽤内存！

__堆：__ 堆是不连续的内存区域，获得的空间⽐较灵活，也⽐较⼤，⼀般速度⽐较慢，⽽且容易产⽣内存碎⽚,不过⽤起来最⽅便。需要程序员申请的内存空间，空间的释放⼀般由程序员控制(⽐如new, delete, malloc, free)。当程序员没有释放该内存空间的时候，程序运⾏完毕时操作系统会对该内存空间进⾏回收。

__栈：__ 栈是⼀块连续的内存的区域，⼀般栈的⼤⼩都是预先设置好的，如果申请的空间超过栈的剩余空间时，将提⽰overflow。存放的通常是变量通常是局部变量、函数参数等。

__常量区：__ 常量字符串就是放在这⾥的。 程序结束后由系统释放。

__BSS段：__ 定义⽽没有赋初值的全局变量和静态变量,放在这个区域，通常只是记录变量名和⼤⼩，相当于⼀个占位符。⼀个程序本质上都是由.bss段、.data段、.text段三个组成的。.data段包含三个部分：heap(堆)、stack(栈)和静态数据区。.text段存放代码区。.bss ⾥⾯装载了未被初始化的数据。如图：

![C++ 内存分区](https://gitee.com/setyan/ImageHost.Gitee.IO/raw/master/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/C++/C++%E7%A8%8B%E5%BA%8F%E5%86%85%E5%AD%98%E5%88%86%E5%8C%BA/C++%E5%86%85%E5%AD%98%E5%88%86%E5%8C%BA.png)

&ensp;&ensp;&ensp;&ensp; ⽰例代码及注释如下：

```C++

int a = 0; //全局初始化区（静态区）
char *p1; //全局未初始化区 （BSS段）
int main() {
    int b; //栈 6 char s[] = "abc"; //栈 7 char *p2; //栈 8 char *p3 = "123456"; //123456/0在常量区，p3在栈上。
    static int c = 0; //全局（静态）初始化区 （静态区）
    p1 = (char *) malloc(10); //分配得10和20字节的区域就在堆区。
    // p2 = (char *) malloc(20);
    strcpy(p1, "123456");
    //123456/0放在常量区，编译器可能会将它与p3所指向的"123456"优化成⼀块。
    return 0;
}
```

